14

AHash(alsoKnownAsAMessageDigest)IsAOne-wayFunction.ItIsConsideredAFunctionBecauseItTakesAnInputMessageAndProducesAnOutput.ItIsCo
nsideredOne-wayBecauseIt’sNotPracticalToFigureOutWhatInputCorrespondsToAGivenOutput.ForAMessageDigestFunctionToBeConsideredCrypt

ographicallySecure,ItMustBeComputationallyInfeasibleToFindAMessageThatHasAGivenPre-specifiedMessageDigest,AndItSimilarlyShouldBe
ImpossibleToFindTwoMessagesThatHaveTheSameMessageDigest.Also(whichFollowsFromThePreviousProperties),GivenAMessageItShouldBeImpos

sibleToFindADifferentMessageWithTheSameMessageDigest.WeWillUseTheTermsHashAndMessageDigestInterchangeably.TheNistMessageDigestUn
ctionIsCalledSha-1,WhichStandsForSecureHashAlgorithm,WhereasTheMdInTheMd2,Md4,AndMd5AlgorithmsStandsForMessageDigest.AllOfTheDig

est/hashAlgorithmsDoBasicallyTheSameThing,WhichIsToTakeAnArbitrary-lengthMessageAndWindUpWithAFixed-lengthQuantity.There’sAnIntu
itiveNotionOfRandomnessThatIsImportantToTheUnderstandingOfMessageDigestFunctions.WeAreNotTryingToCreateAMathBook,SoOurDescriptio

nWillBeMathematicallyImprecise.WeAreMerelyTryingToCaptureTheIntuition.WeExplainedBeforeThatWithSecretKeyCryptography,ItIsDesirab
leForTheMappingFromInputToOutputToAppearRandomlyChosen.InOtherWords,ItShouldLook(toSomeoneWhoDoesNotKnowTheSecretKey)LikeSomeone

FlippedCoinsToDetermine,ForEachPossibleInput,WhatTheOutputShouldBe.if1000InputsAreSelectedAtRandom,AnyParticularBitInThe1000Resu
ltingOutputsShouldBeOnAboutHalfTheTime.112HashesAndMessageDigests5.1•EachOutputShouldHave,WithHighProbability,AboutHalfTheBitsOn

.•AnyTwoOutputsShouldBeCompletelyUncorrelated,NoMatterHowSimilarTheInputsAre.SoForInstance,TwoInputsThatDifferByOnlyOneBitShould
HaveOutputsThatLookLikeCompletelyIndependentlyChosenRandomNumbers.AboutHalfTheBitsInTheTwoOutputsShouldDiffer.ThisSortOfRandomne

ssIsImportantForMessageDigestsAsWell.ItIsTrueThatSomeoneWhoKnowsTheMessageAndTheDigestFunctionCanCalculateTheOutput,AndTherefore
TheOutputIsCertainlyProvablyNotGeneratedByFlippingCoins.ButIgnoringThat,TheOutputShouldLookRandom.ItShouldNotBePossible,OtherTha

nByComputingTheMessageDigest,ToPredictAnyPortionOfTheOutput.AndInParticularItShouldBeTrueThat,ForAnySubsetOfBitsInTheMessageDige
st,TheOnlyWayOfObtainingTwoMessagesWithTheSameValueInThoseBitsWouldBeToTryMessagesAtRandomAndComputeTheMessageDigestOfEachUntilT

woHappenedToHaveTheSameValue.GivenThisProperty,ASecureMessageDigestFunctionWithNBitsShouldBeDerivableFromAMessageDigestFunctionW
ithMoreThanNBitsMerelyByTakingAnyParticularSubsetOfNBitsFromTheLargerMessageDigest.ThereCertainlyWillBeManyMessagesThatYieldTheS

ameMessageDigest,BecauseAMessageCanBeOfArbitraryLengthAndTheMessageDigestWillBeSomeFixedLength,ForInstance128Bits.ForInstance,Fo
r1000-bitMessagesAndA128-bitMessageDigest,ThereAreOnTheAverage2872MessagesThatMapToAnyOneParticularMessageDigest.SoCertainly,ByT

ryingLotsOfMessages,OneWouldEventuallyFindTwoThatMappedToTheSameMessageDigest.TheProblemIsThat“lots”IsSoManyThatItIsEssentiallyI
mpossible.AssumingAGood128-bitMessageDigestFunction,ItWouldTakeTryingApproximately2128PossibleMessagesBeforeOneWouldFindAMessage

ThatMappedToAParticularMessageDigest,OrApproximately264MessagesBeforeFindingTwoThatHadTheSameDigest(seeTheBirthdayProblem,Below)
.AnExampleUseOfAMessageDigestIsToFingerprintAProgramOrDocumentToDetectModificationOfIt.IfYouKnowTheMessageDigestOfTheProgram(and

StoreTheMessageDigestSecurelySoThatItCan’tBeModified,AndComputeTheMessageDigestOfTheProgramBeforeRunningIt,AndCheckToMakeSureTha
tItMatchesTheStoredValue),ThenNobodyWillBeAbleToModifyTheProgramWithoutBeingDetected,BecauseTheyWillNotBeAbleToFindADifferentPro

