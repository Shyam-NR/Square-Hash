14
Ahash(alsoknownasamessagedigest)isaone-wayfunction.Itisconsideredafunctionbecauseittakesaninputmessageandproducesanoutput.Itisco
nsideredone-waybecauseit’snotpracticaltofigureoutwhatinputcorrespondstoagivenoutput.Foramessagedigestfunctiontobeconsideredcrypt

ographicallysecure,itmustbecomputationallyinfeasibletofindamessagethathasagivenpre-specifiedmessagedigest,anditsimilarlyshouldbe
impossibletofindtwomessagesthathavethesamemessagedigest.Also(whichfollowsfromthepreviousproperties),givenamessageitshouldbeimpos

sibletofindadifferentmessagewiththesamemessagedigest.Wewillusethetermshashandmessagedigestinterchangeably.TheNISTmessagedigestun
ctioniscalledSHA-1,whichstandsforsecurehashalgorithm,whereastheMDintheMD2,MD4,andMD5algorithmsstandsformessagedigest.Allofthedig

est/hashalgorithmsdobasicallythesamething,whichistotakeanarbitrary-lengthmessageandwindupwithafixed-lengthquantity.There’sanintu
itivenotionofrandomnessthatisimportanttotheunderstandingofmessagedigestfunctions.Wearenottryingtocreateamathbook,soourdescriptio

nwillbemathematicallyimprecise.Wearemerelytryingtocapturetheintuition.Weexplainedbeforethatwithsecretkeycryptography,itisdesirab
leforthemappingfrominputtooutputtoappearrandomlychosen.Inotherwords,itshouldlook(tosomeonewhodoesnotknowthesecretkey)likesomeone

flippedcoinstodetermine,foreachpossibleinput,whattheoutputshouldbe.If1000inputsareselectedatrandom,anyparticularbitinthe1000resu
ltingoutputsshouldbeonabouthalfthetime.112HASHESANDMESSAGEDIGESTS5.1•Eachoutputshouldhave,withhighprobability,abouthalfthebitson

.•Anytwooutputsshouldbecompletelyuncorrelated,nomatterhowsimilartheinputsare.Soforinstance,twoinputsthatdifferbyonlyonebitshould
haveoutputsthatlooklikecompletelyindependentlychosenrandomnumbers.Abouthalfthebitsinthetwooutputsshoulddiffer.Thissortofrandomne

ssisimportantformessagedigestsaswell.Itistruethatsomeonewhoknowsthemessageandthedigestfunctioncancalculatetheoutput,andtherefore
theoutputiscertainlyprovablynotgeneratedbyflippingcoins.Butignoringthat,theoutputshouldlookrandom.Itshouldnotbepossible,othertha

nbycomputingthemessagedigest,topredictanyportionoftheoutput.Andinparticularitshouldbetruethat,foranysubsetofbitsinthemessagedige
st,theonlywayofobtainingtwomessageswiththesamevalueinthosebitswouldbetotrymessagesatrandomandcomputethemessagedigestofeachuntilt

wohappenedtohavethesamevalue.Giventhisproperty,asecuremessagedigestfunctionwithnbitsshouldbederivablefromamessagedigestfunctionw
ithmorethannbitsmerelybytakinganyparticularsubsetofnbitsfromthelargermessagedigest.Therecertainlywillbemanymessagesthatyieldthes

amemessagedigest,becauseamessagecanbeofarbitrarylengthandthemessagedigestwillbesomefixedlength,forinstance128bits.Forinstance,fo
r1000-bitmessagesanda128-bitmessagedigest,thereareontheaverage2872messagesthatmaptoanyoneparticularmessagedigest.Socertainly,byt

ryinglotsofmessages,onewouldeventuallyfindtwothatmappedtothesamemessagedigest.Theproblemisthat“lots”issomanythatitisessentiallyi
mpossible.Assumingagood128-bitmessagedigestfunction,itwouldtaketryingapproximately2128possiblemessagesbeforeonewouldfindamessage

thatmappedtoaparticularmessagedigest,orapproximately264messagesbeforefindingtwothathadthesamedigest(seeTheBirthdayProblem,below)
.Anexampleuseofamessagedigestistofingerprintaprogramordocumenttodetectmodificationofit.Ifyouknowthemessagedigestoftheprogram(and

storethemessagedigestsecurelysothatitcan’tbemodified,andcomputethemessagedigestoftheprogrambeforerunningit,andchecktomakesuretha
titmatchesthestoredvalue),thennobodywillbeabletomodifytheprogramwithoutbeingdetected,becausetheywillnotbeabletofindadifferentpro
